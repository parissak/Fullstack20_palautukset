(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{17:function(e,t,n){e.exports=n(40)},40:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(15),c=n.n(u),o=n(16),l=n(1),i=n.n(l),s=n(3),p=n(4),m=function(e){var t=e.blog,n=e.updateBlogLike,u=e.removeBlog,c=e.userId,o=Object(r.useState)(!1),l=Object(p.a)(o,2),i=l[0],s=l[1],m={display:i?"":"none"},f={display:i?"none":""},d={margin:4};return a.a.createElement("div",{style:{border:"solid",borderWidth:"thin",padding:4,margin:4}},a.a.createElement("div",null,t.title," by ",t.author,a.a.createElement("button",{style:d,onClick:function(){s(!i)}},a.a.createElement("span",{style:m}," hide "),a.a.createElement("span",{style:f}," show "))),a.a.createElement("div",{style:m},a.a.createElement("div",null,t.url),a.a.createElement("div",null,"likes: ",t.likes,a.a.createElement("button",{style:d,onClick:function(){n(t)}}," like ")),a.a.createElement("div",null,"added by: ",t.user.username),c===t.user.id&&a.a.createElement("button",{onClick:function(){u(t)}}," remove ")))},f=function(e){var t=e.addBlog,n=Object(r.useState)(""),u=Object(p.a)(n,2),c=u[0],o=u[1],l=Object(r.useState)(""),m=Object(p.a)(l,2),f=m[0],d=m[1],v=Object(r.useState)(""),b=Object(p.a)(v,2),g=b[0],h=b[1],E=Object(r.useState)(!1),w=Object(p.a)(E,2),y=w[0],k=w[1],O={display:y?"none":""},j={display:y?"":"none"},x=function(){k(!y)},S=function(){var e=Object(s.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({title:c,author:f,url:g}),k(!1),o(""),d(""),h("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("div",{style:O},a.a.createElement("button",{onClick:x},"new note")),a.a.createElement("div",{style:j},a.a.createElement("form",{onSubmit:S},a.a.createElement("h2",null,"create new"),a.a.createElement("div",null," title: ",a.a.createElement("input",{name:"title",type:"text",value:c,onChange:function(e){var t=e.target;return o(t.value)}})),a.a.createElement("div",null," author: ",a.a.createElement("input",{name:"author",type:"text",value:f,onChange:function(e){var t=e.target;return d(t.value)}})),a.a.createElement("div",null," url: ",a.a.createElement("input",{name:"url",type:"text",value:g,onChange:function(e){var t=e.target;return h(t.value)}})),a.a.createElement("button",{type:"submit"}," create new blog ")),a.a.createElement("button",{onClick:x},"cancel")))},d=function(e){var t=e.message;if(!t)return null;var n="error"===t.type?{color:"red",fontSize:20}:{color:"green",fontSize:20};return a.a.createElement("div",{style:n},a.a.createElement("p",null," ",t.message," "))},v=n(5),b=n.n(v),g=null,h={setToken:function(e){g="bearer ".concat(e)},getAll:function(){return b.a.get("/api/blogs").then((function(e){return e.data}))},post:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,b.a.post("/api/blogs",t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),put:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put("".concat("/api/blogs","/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,b.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},E={login:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w=function(){var e=Object(r.useState)([]),t=Object(p.a)(e,2),n=t[0],u=t[1],c=Object(r.useState)(""),l=Object(p.a)(c,2),v=l[0],b=l[1],g=Object(r.useState)(""),w=Object(p.a)(g,2),y=w[0],k=w[1],O=Object(r.useState)(null),j=Object(p.a)(O,2),x=j[0],S=j[1],C=Object(r.useState)(null),B=Object(p.a)(C,2),I=B[0],z=B[1],A=n.sort((function(e,t){return t.likes-e.likes}));Object(r.useEffect)((function(){h.getAll().then((function(e){return u(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);S(t),h.setToken(t.token)}}),[]);var J=function(){S(null),window.localStorage.removeItem("loggedUser")},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";z({message:e,type:t}),setTimeout((function(){z(null)}),4e3)},U=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,E.login({username:v,password:y});case 4:n=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(n)),S(n),b(""),k(""),h.setToken(n.token),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),T("wrong username or password","error");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(s.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.post(t);case 3:r=e.sent,u(n.concat(r)),T("".concat(t.title," added succesfully")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),T("required information missing","error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(s.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.find((function(e){return e.id===t.id})),a=Object(o.a)({},r,{likes:r.likes+1}),e.next=5,h.put(a);case 5:u(n.map((function(e){return e.id===t.id?a:e}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),T("something went wrong when updating blog","error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("remove ".concat(t.title," by ").concat(t.author,"?"))){e.next=11;break}return e.prev=2,e.next=5,h.remove(t.id);case 5:u(n.filter((function(e){return e!==t}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),e.t0.message.includes("403")?T("You are not authorized to remove this blog","error"):T("something went wrong when removing blog","error");case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement(d,{message:I}),null===x?a.a.createElement("form",{onSubmit:U},a.a.createElement("div",null,a.a.createElement("h2",null,"log in to application"),a.a.createElement("div",null," username ",a.a.createElement("input",{name:"username",type:"text",value:v,onChange:function(e){var t=e.target;return b(t.value)}})),a.a.createElement("div",null," password ",a.a.createElement("input",{name:"password",type:"password",value:y,onChange:function(e){var t=e.target;return k(t.value)}})),a.a.createElement("button",{type:"submit"}," login "))):a.a.createElement("div",null,a.a.createElement("h2",null,"blogs"),a.a.createElement("p",null,x.name," logged in ",a.a.createElement("button",{onClick:J}," logout ")," "),A.map((function(e){return a.a.createElement(m,{key:e.id,blog:e,updateBlogLike:L,removeBlog:N,userId:x.id})}))),null!==x&&a.a.createElement(f,{addBlog:D}))};c.a.render(a.a.createElement(w,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.6f5d4cf4.chunk.js.map